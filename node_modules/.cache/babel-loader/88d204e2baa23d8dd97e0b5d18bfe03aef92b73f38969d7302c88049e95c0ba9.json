{"ast":null,"code":"import { createAsyncThunk } from '@reduxjs/toolkit';\nimport { API, PublicApi } from \"./api\";\nimport axios from 'axios';\n\n// export const updateUser = createAsyncThunk(\n//   'users/updateUser',\n//   async (_,thunkAPI) => {\n//     try{\n//         let userId = localStorage.getItem('userID')\n//         const response = await PublicApi.get(`/auth/users/${userId}`);\n//         console.log(response.data)\n//         return response.data;\n//     }\n//     catch (err) {\n//         return thunkAPI.rejectWithValue(err.response.data.message);            \n//     }\n\n//   }\n// );\n//   export const updateUser = createAsyncThunk(\n//     \"user/updateUser\",\n//     async ({userData},{ rejectWithValue }) => {\n//       try {\n//         const userID = localStorage.getItem(\"userID\");\n\n//         const response = await API.patch(`auth/users/${userID}/`,userData);  \n//         console.log(response.data)\n\n//         return response.data;\n//       } catch (error) {\n//         return rejectWithValue(error.response.data);\n//       }\n//     }\n//   );\n\nexport const updateUser = createAsyncThunk(\"user/updateUser\", async (_ref, _ref2) => {\n  let {\n    userData\n  } = _ref;\n  let {\n    rejectWithValue\n  } = _ref2;\n  try {\n    const userID = localStorage.getItem(\"userID\");\n    const imageFile = userData.profile_picture;\n    const base64String = await new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.readAsDataURL(imageFile);\n      reader.onload = event => {\n        resolve(event.target.result);\n      };\n      reader.onerror = error => {\n        reject(error);\n      };\n    });\n    const formData = new FormData();\n    formData.append(\"first_name\", userData.first_name);\n    formData.append(\"last_name\", userData.last_name);\n    formData.append(\"email\", userData.email);\n    formData.append(\"old_password\", userData.oldPassword);\n    formData.append(\"new_password\", userData.password);\n    formData.append(\"profile_picture\", base64String);\n    const response = await API.patch(`auth/users/${userID}/`, formData);\n    console.log(response.data);\n    return response.data;\n  } catch (error) {\n    return rejectWithValue(error.response.data);\n  }\n});","map":{"version":3,"names":["createAsyncThunk","API","PublicApi","axios","updateUser","userData","rejectWithValue","userID","localStorage","getItem","imageFile","profile_picture","base64String","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","event","target","result","onerror","error","formData","FormData","append","first_name","last_name","email","oldPassword","password","response","patch","console","log","data"],"sources":["/Users/sabrina_/Documents/prog/G4G-project/g4g/src/api/user.js"],"sourcesContent":["import { createAsyncThunk } from '@reduxjs/toolkit';\nimport { API, PublicApi } from \"./api\";\n\nimport axios from 'axios';\n\n// export const updateUser = createAsyncThunk(\n//   'users/updateUser',\n//   async (_,thunkAPI) => {\n//     try{\n//         let userId = localStorage.getItem('userID')\n//         const response = await PublicApi.get(`/auth/users/${userId}`);\n//         console.log(response.data)\n//         return response.data;\n//     }\n//     catch (err) {\n//         return thunkAPI.rejectWithValue(err.response.data.message);            \n//     }\n\n//   }\n// );\n//   export const updateUser = createAsyncThunk(\n//     \"user/updateUser\",\n//     async ({userData},{ rejectWithValue }) => {\n//       try {\n//         const userID = localStorage.getItem(\"userID\");\n  \n//         const response = await API.patch(`auth/users/${userID}/`,userData);  \n//         console.log(response.data)\n\n//         return response.data;\n//       } catch (error) {\n//         return rejectWithValue(error.response.data);\n//       }\n//     }\n//   );\n\nexport const updateUser = createAsyncThunk(\n  \"user/updateUser\",\n  async ({ userData }, { rejectWithValue }) => {\n    try {\n      const userID = localStorage.getItem(\"userID\");\n\n      const imageFile = userData.profile_picture;\n      const base64String = await new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.readAsDataURL(imageFile);\n        reader.onload = (event) => {\n          resolve(event.target.result);\n        };\n        reader.onerror = (error) => {\n          reject(error);\n        };\n      });\n\n      const formData = new FormData();\n      formData.append(\"first_name\", userData.first_name);\n      formData.append(\"last_name\", userData.last_name);\n      formData.append(\"email\", userData.email);\n      formData.append(\"old_password\", userData.oldPassword);\n      formData.append(\"new_password\", userData.password);\n      formData.append(\"profile_picture\", base64String);\n\n      const response = await API.patch(`auth/users/${userID}/`, formData);\n\n      console.log(response.data);\n      return response.data;\n    } catch (error) {\n      return rejectWithValue(error.response.data);\n    }\n  }\n);\n\n"],"mappings":"AAAA,SAASA,gBAAgB,QAAQ,kBAAkB;AACnD,SAASC,GAAG,EAAEC,SAAS,QAAQ,OAAO;AAEtC,OAAOC,KAAK,MAAM,OAAO;;AAEzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,MAAMC,UAAU,GAAGJ,gBAAgB,CACxC,iBAAiB,EACjB,uBAA6C;EAAA,IAAtC;IAAEK;EAAS,CAAC;EAAA,IAAE;IAAEC;EAAgB,CAAC;EACtC,IAAI;IACF,MAAMC,MAAM,GAAGC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;IAE7C,MAAMC,SAAS,GAAGL,QAAQ,CAACM,eAAe;IAC1C,MAAMC,YAAY,GAAG,MAAM,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MAC1D,MAAMC,MAAM,GAAG,IAAIC,UAAU,EAAE;MAC/BD,MAAM,CAACE,aAAa,CAACR,SAAS,CAAC;MAC/BM,MAAM,CAACG,MAAM,GAAIC,KAAK,IAAK;QACzBN,OAAO,CAACM,KAAK,CAACC,MAAM,CAACC,MAAM,CAAC;MAC9B,CAAC;MACDN,MAAM,CAACO,OAAO,GAAIC,KAAK,IAAK;QAC1BT,MAAM,CAACS,KAAK,CAAC;MACf,CAAC;IACH,CAAC,CAAC;IAEF,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,EAAE;IAC/BD,QAAQ,CAACE,MAAM,CAAC,YAAY,EAAEtB,QAAQ,CAACuB,UAAU,CAAC;IAClDH,QAAQ,CAACE,MAAM,CAAC,WAAW,EAAEtB,QAAQ,CAACwB,SAAS,CAAC;IAChDJ,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAEtB,QAAQ,CAACyB,KAAK,CAAC;IACxCL,QAAQ,CAACE,MAAM,CAAC,cAAc,EAAEtB,QAAQ,CAAC0B,WAAW,CAAC;IACrDN,QAAQ,CAACE,MAAM,CAAC,cAAc,EAAEtB,QAAQ,CAAC2B,QAAQ,CAAC;IAClDP,QAAQ,CAACE,MAAM,CAAC,iBAAiB,EAAEf,YAAY,CAAC;IAEhD,MAAMqB,QAAQ,GAAG,MAAMhC,GAAG,CAACiC,KAAK,CAAE,cAAa3B,MAAO,GAAE,EAAEkB,QAAQ,CAAC;IAEnEU,OAAO,CAACC,GAAG,CAACH,QAAQ,CAACI,IAAI,CAAC;IAC1B,OAAOJ,QAAQ,CAACI,IAAI;EACtB,CAAC,CAAC,OAAOb,KAAK,EAAE;IACd,OAAOlB,eAAe,CAACkB,KAAK,CAACS,QAAQ,CAACI,IAAI,CAAC;EAC7C;AACF,CAAC,CACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}